!function(){var t=function(){function t(t){this.el=t||[[0,0,0],[0,0,0],[0,0,0]]}return t.prototype.setTranslate=function(t,e){return this.el=[[0,0,0],[0,0,0],[t,e,1]],el},t.prototype.setRotation=function(t){return t=t*Math.PI/180,this.el=[[Math.cos(t),Math.sin(t),0],[-Math.sin(t),Math.cos(t),0],[0,0,1]],el},t.prototype.mult=function(e){if("Matrix"==typeof e){for(var i=[],o=0;o<this.el.length;o++){for(var s=[],n=0;n<e[0].length;n++){for(var r=0,c=0;c<this.el[0].length;c++)r+=this.el[o][c]*e[c][n];s.push(r)}i.push(s)}return new t(i)}if("Vector"==typeof e){for(var i=[],o=0;o<this.el.length;o++){for(var r=0,c=0;c<this.el[0].length;c++)r+=this.el[o][c]*e[c];i.push(r)}return new t(i)}},t}(),e=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.exportArray=function(){return[this.x,this.y]},t.prototype.exportArrayAffine=function(){return[this.x,this.y,1]},t.prototype.importArray=function(t){this.x=t[0],this.y=t[1]},t.prototype.translate=function(t,e){this.x+=t,this.y+=e},t.prototype.translateVec=function(t){this.x+=t.x,this.y+=t.y},t.prototype.rotateVec=function(t,e){t=t*Math.PI/180,this.x=x*Math.cos(t)-y*Math.sin(t)-e.x*(Math.cos(t)-1)+e.y*Math.sin(t),this.y=y*Math.sin(t)+y*Math.cos(t)-e.y*(Math.cos(t)-1)+e.x*Math.sin(t)},t}();window.a={Matrix:t,Vector:e}}(),function(){var t=function(){function t(){this.objects=[]}function e(t){if(t.length<2)return t;var o=Math.floor(t.length/2),s=t.slice(0,o),n=t.slice(o,t.length);return i(e(s),e(n))}function i(t,e){for(var i=[];t.length>0&&e.length>0;)-1==t[0].compare(e[0])?i.push(t.shift()):i.push(e.shift());for(;t.length>0;)i.push(t.shift());for(;e.length>0;)i.push(e.shift());return i}return t.prototype.add=function(t){this.objects.push(t)},t.prototype.run=function(){this.sort(),this.validate()},t.prototype.sort=function(){this.objects=e(this.objects)},t.prototype.validate=function(){for(var t=0;t<this.objects.length;t++)for(var e=!0,i=t;e&&!(i+1>=this.objects.length);)e=this.objects[t].validate(this.objects[i+1]),e&&(this.objects[t].collided=!0,this.objects[i+1].collided=!0),i+=1},t}(),e=function(){function t(t,e,i){this.min=t||{x:0,y:0},this.max=e||{x:0,y:0},this.id=i}return t.prototype.compare=function(t){return this.min.x<t.min.x||this.min.x==t.min.x&&this.min.y<t.min.y?-1:this.min.x==t.min.x&&this.min.y==t.min.y?0:this.min.x>t.min.x||this.min.y>t.min.y?1:void 0},t.prototype.validate=function(t){return this.max.x>=t.min.x&&this.max.y>=t.min.y&&this.min.y<=t.max.y},t}();window.c={Collider:t,SolidBody:e}}(),function(){var t=18,e=function(){function e(t,e){this.mediaStorage=new l(this),this.canvas=document.createElement("canvas"),this.canvas.width=t||window.innerWidth,this.canvas.height=e||window.innerHeight,this.context=this.canvas.getContext("2d"),this.world=[],this.screen=new o(this.canvas.width,this.canvas.height),this.cursor=new s(this.screen.center.x,this.screen.center.y,this.canvas),this.state=new i,this.cursor.setListener(),document.body.insertBefore(this.canvas,document.body.childNodes[0]),r()}function r(t){var e=document.querySelector("link[rel*='icon']")||document.createElement("link");e.type="image/x-icon",e.rel="shortcut icon",e.href="https://puu.sh/vdJf9/0aaeac54da.png",document.getElementsByTagName("head")[0].appendChild(e)}return e.prototype.loop=function(){var e=this;setInterval(function(){e.camera.change(),e.calculateCursorAngle(),e.context.clearRect(0,0,e.canvas.width,e.canvas.height);for(var t=0;t<e.world.length;t++)e.world[t].change();for(var t=0;t<e.world.length;t++)e.world[t].draw(e.context,e.camera,t==e.world.length-1,e.cursor)},t)},e.prototype.addObject=function(t){this.world.unshift(t)},e.prototype.calculateCursorAngle=function(){var t=this.screen.center.y-this.cursor.vector.y,e=this.screen.center.x-this.cursor.vector.x;this.cursor.angle=Math.atan2(t,e)},e.prototype.setCamera=function(t){this.camera=t,this.camera.screen=this.screen},e.prototype.addCursorGameObject=function(t){var e=this,i=new n(0,0,function(t){t.x=e.cursor.getPosition().x,t.y=e.cursor.getPosition().y},void 0,t);this.world.unshift(i)},e}(),i=function(){function t(){var t=this;this.top=!1,this.left=!1,this.right=!1,this.bottom=!1,this.mouseclick=!1,document.addEventListener("keydown",function(e){87==e.keyCode&&(t.top=!0),65==e.keyCode&&(t.left=!0),83==e.keyCode&&(t.bottom=!0),68==e.keyCode&&(t.right=!0)},!1),document.addEventListener("keyup",function(e){87==e.keyCode&&(t.top=!1),65==e.keyCode&&(t.left=!1),83==e.keyCode&&(t.bottom=!1),68==e.keyCode&&(t.right=!1)},!1),document.addEventListener("onmousedown",function(e){t.mouseclick=!0},!1),document.addEventListener("onmouseup",function(e){t.mouseclick=!1},!1),document.addEventListener("contextmenu",function(t){t.preventDefault()},!1)}return t}(),o=function(){function t(t,e){this.w=t,this.h=e,this.center=new a.Vector(Math.round(t/2),Math.round(e/2))}return t}(),s=function(){function t(t,e,i){this.vector=new a.Vector(t,e),this.canvas=i,i&&this.setListener(i),this.rotationByCursor=!1,this.angle=0}return t.prototype.setListener=function(){var t=this;t.canvas.addEventListener("mousemove",function(e){var i=t.canvas.getBoundingClientRect();t.vector.x=e.clientX-i.left,t.vector.y=e.clientY-i.top},!1)},t.prototype.getPosition=function(){return this.vector},t}(),n=function(){function t(t,e,i,o,s,n){this.vector=new a.Vector(t,e),this.conversion=i||function(t){t.translate(0,0)},this.gameState=o,this.sprites=[s],this.currentSprite=0,this.controller=n,this.controller&&(this.controller.ownVec=this.vector)}return t.prototype.change=function(){this.conversion(this.vector,this.gameState,this.controller)},t.prototype.draw=function(t,e,i,o){this.sprites[this.currentSprite]&&(this.sprites[this.currentSprite].draw(t,this.vector,e,i,o),this.sprites[this.currentSprite].next())},t}(),r=function(){function t(t,e,i,o,s){this.vector=new a.Vector(t,e),this.conversion=i||function(t){t.translate(0,0)},this.gameState=o,this.controller=s,this.controller&&(this.controller.ownVec=this.vector)}return t.prototype.change=function(){this.conversion(this.vector,this.gameState,this.controller)},t}(),c=function(){function e(e,i,o,s,n,r,c,h,a){this.source=e,this.w=i,this.h=o,this.duration=s,this.animationLength=r,this.frameDuration=Math.round(this.duration/t/r),this.currentFrameLifeTime=0,this.firstFrame=n,this.currentFrame=this.firstFrame,this.reverse=!1,this.bounce=c||!1,this.static=h,this.altitude=a}return e.prototype.next=function(){this.currentFrameLifeTime==this.frameDuration?(this.currentFrameLifeTime=0,this.currentFrame+=this.reverse?-1:1):this.currentFrameLifeTime++,this.currentFrame==this.animationLength-1?this.bounce?this.reverse=!0:this.currentFrame=0:0==this.currentFrame&&this.reverse&&(this.reverse=!1)},e.prototype.draw=function(t,e,i,o,s){var n=this;if(n.source){var r=0,c=0;s.rotationByCursor&&!o&&(r=20*Math.cos(s.angle),c=20*Math.sin(s.angle)),t.drawImage(n.source,n.currentFrame*n.w,0,n.w,n.h,e.x-Math.round(n.w/2)-(this.static?0:((o?0:Math.round(i.vector.x-i.screen.w/2))+r)*(n.altitude?n.altitude:1)),e.y-Math.round(n.h/2)-(this.static?0:((o?0:Math.round(i.vector.y-i.screen.h/2))+c)*(n.altitude?n.altitude:1)),n.w,n.h)}},e}(),h=function(){function t(t,e,i,o,s,n,r){this.velocity=t,this.acceleration=e,this.gameState=i,this.accelerationBoost=o,this.maxVelocity=s,this.minVelocity=-s,this.slipCoefficient=n,this.prevVelocity=t,this.linkedVec=r,this.ownVec={x:0,y:0}}return t.prototype.accelerate=function(){return this.setAcceleration(),this.velocity.x+=this.velocity.x<this.maxVelocity&&this.velocity.x>this.minVelocity?this.acceleration.x:0,this.velocity.y+=this.velocity.y<this.maxVelocity&&this.velocity.y>this.minVelocity?this.acceleration.y:0,this.velocity.x=this.velocity.x>this.maxVelocity?this.maxVelocity:this.velocity.x,this.velocity.y=this.velocity.y>this.maxVelocity?this.maxVelocity:this.velocity.y,this.velocity.x=this.velocity.x<this.minVelocity?this.minVelocity:this.velocity.x,this.velocity.y=this.velocity.y<this.minVelocity?this.minVelocity:this.velocity.y,this.absoluteStopMinVelocity(),this.prevVelocity.x=this.velocity.x,this.prevVelocity.y=this.velocity.y,this.velocity},t.prototype.setAcceleration=function(){this.linkedVec?(this.linkedVec.x<this.ownVec.x?this.acceleration.x=-this.accelerationBoost:this.linkedVec.x>this.ownVec.x?this.acceleration.x=this.accelerationBoost:this.acceleration.x=0,this.linkedVec.y<this.ownVec.y?this.acceleration.y=-this.accelerationBoost:this.linkedVec.y>this.ownVec.y?this.acceleration.y=this.accelerationBoost:this.acceleration.y=0):(this.gameState.left?this.acceleration.x=-this.accelerationBoost:this.gameState.right?this.acceleration.x=this.accelerationBoost:this.acceleration.x=0,this.gameState.top?this.acceleration.y=-this.accelerationBoost:this.gameState.bottom?this.acceleration.y=this.accelerationBoost:this.acceleration.y=0)},t.prototype.absoluteStopMinVelocity=function(){this.velocity.x==this.prevVelocity.x&&0!=this.velocity.x&&this.velocity.x<1&&this.velocity.x>-1&&(this.velocity.x=0),this.velocity.y==this.prevVelocity.y&&0!=this.velocity.y&&this.velocity.y<1&&this.velocity.y>-1&&(this.velocity.y=0)},t.prototype.slip=function(){this.velocity.x-=!this.gameState.right&&this.velocity.x>0?this.slipCoefficient:0,this.velocity.x-=!this.gameState.left&&this.velocity.x<0?-this.slipCoefficient:0,this.velocity.y-=!this.gameState.top&&this.velocity.y<0?-this.slipCoefficient:0,this.velocity.y-=!this.gameState.bottom&&this.velocity.y>0?this.slipCoefficient:0},t}(),l=function(){function t(t){this.game=t,this.storage={}}return t.prototype.add=function(t,e,i){var o=new Image;o.src=e;var s={item:o,references:[]};return i?(this.storage[i]||(this.storage[i]={}),this.storage[i][t]=s,this.storage[i][t]):(this.storage[t]=s,this.storage[t])},t.prototype.remove=function(t,e){if(e){for(var i=0;i<this.storage[e][t].references.length;i++)this.game.world[this.storage[e][t].references[i]].removeSprite(t);this.storage[e][t]=void 0}else{if(this.storage[t]instanceof Object)for(var o in this.storage[t])this.remove(o,t);else for(var i=0;i<this.storage[t].references.length;i++)this.game.world[this.storage[t].references[i]].removeSprite(t);this.storage[t]=void 0}return t},t.prototype.clean=function(){for(var t in this.storage)this.remove(t)},t.prototype.get=function(t,e,i){return i?(this.storage[i][t].references.push(e),this.storage[i][t].item):this.storage[t].references?(this.storage[t].references.push(e),this.storage[t].item):void 0},t}();window.e={Game:e,Camera:r,Screen:o,GameObject:n,Sprite:c,Controller:h,MediaStorage:l}}();