!function(){var t=function(){function t(t){this.el=t||[[0,0,0],[0,0,0],[0,0,0]]}return t.prototype.setTranslate=function(t,i){return this.el=[[0,0,0],[0,0,0],[t,i,1]],el},t.prototype.setRotation=function(t){return t=t*Math.PI/180,this.el=[[Math.cos(t),Math.sin(t),0],[-Math.sin(t),Math.cos(t),0],[0,0,1]],el},t.prototype.mult=function(i){if("Matrix"==typeof i){for(var e=[],o=0;o<this.el.length;o++){for(var n=[],s=0;s<i[0].length;s++){for(var r=0,c=0;c<this.el[0].length;c++)r+=this.el[o][c]*i[c][s];n.push(r)}e.push(n)}return new t(e)}if("Vector"==typeof i){for(var e=[],o=0;o<this.el.length;o++){for(var r=0,c=0;c<this.el[0].length;c++)r+=this.el[o][c]*i[c];e.push(r)}return new t(e)}},t}(),i=function(){function t(t,i){this.x=t,this.y=i}return t.prototype.exportArray=function(){return[this.x,this.y]},t.prototype.exportArrayAffine=function(){return[this.x,this.y,1]},t.prototype.importArray=function(t){this.x=t[0],this.y=t[1]},t.prototype.translate=function(t,i){this.x+=t,this.y+=i},t.prototype.translateVec=function(t){this.x+=t.x,this.y+=t.y},t.prototype.rotateVec=function(t,i){t=t*Math.PI/180,this.x=x*Math.cos(t)-y*Math.sin(t)-i.x*(Math.cos(t)-1)+i.y*Math.sin(t),this.y=y*Math.sin(t)+y*Math.cos(t)-i.y*(Math.cos(t)-1)+i.x*Math.sin(t)},t}();window.a={Matrix:t,Vector:i}}(),function(){var t=function(){function t(){this.objects=[]}function i(t){if(t.length<2)return t;var o=Math.floor(t.length/2),n=t.slice(0,o),s=t.slice(o,t.length);return e(i(n),i(s))}function e(t,i){for(var e=[];t.length>0&&i.length>0;)-1==t[0].compare(i[0])?e.push(t.shift()):e.push(i.shift());for(;t.length>0;)e.push(t.shift());for(;i.length>0;)e.push(i.shift());return e}return t.prototype.add=function(t){this.objects.push(t)},t.prototype.run=function(){this.sort(),this.validate()},t.prototype.sort=function(){this.objects=i(this.objects)},t.prototype.validate=function(){for(var t=0;t<this.objects.length;t++)for(var i=!0,e=t;i&&!(e+1>=this.objects.length);)i=this.objects[t].validate(this.objects[e+1]),i&&(this.objects[t].collided=!0,this.objects[e+1].collided=!0),e+=1},t}(),i=function(){function t(t,i,e){this.min=t||{x:0,y:0},this.max=i||{x:0,y:0},this.id=e}return t.prototype.compare=function(t){return this.min.x<t.min.x||this.min.x==t.min.x&&this.min.y<t.min.y?-1:this.min.x==t.min.x&&this.min.y==t.min.y?0:this.min.x>t.min.x||this.min.y>t.min.y?1:void 0},t.prototype.validate=function(t){return this.max.x>=t.min.x&&this.max.y>=t.min.y&&this.min.y<=t.max.y},t}();window.c={Collider:t,SolidBody:i}}(),function(){var t=18,i=function(){function i(t,i){this.canvas=document.createElement("canvas"),this.canvas.width=t||window.innerWidth,this.canvas.height=i||window.innerHeight,this.context=this.canvas.getContext("2d"),this.worldList=[],this.screen=new o(this.canvas.width,this.canvas.height),this.cursor=new n(this.screen.center.x,this.screen.center.y,this.canvas),this.state=new e,this.cursor.setListener(),document.body.insertBefore(this.canvas,document.body.childNodes[0])}return i.prototype.loop=function(){var i=this;setInterval(function(){i.camera.change(),i.calculateCursorAngle(),i.context.clearRect(0,0,i.canvas.width,i.canvas.height);for(var t=0;t<i.worldList.length;t++)i.worldList[t].change();for(var t=0;t<i.worldList.length;t++)i.worldList[t].draw(i.context,i.camera,t==i.worldList.length-1,i.cursor)},t)},i.prototype.addObject=function(t){this.worldList.unshift(t)},i.prototype.calculateCursorAngle=function(){var t=this.screen.center.y-this.cursor.vector.y,i=this.screen.center.x-this.cursor.vector.x;this.cursor.angle=Math.atan2(t,i)},i.prototype.setCamera=function(t){this.camera=t,this.camera.screen=this.screen},i.prototype.addCursorGameObject=function(t){var i=this,e=new s(0,0,function(t){t.x=i.cursor.getPosition().x,t.y=i.cursor.getPosition().y});e.sprite=t,this.worldList.unshift(e)},i}(),e=function(){function t(){var t=this;this.top=!1,this.left=!1,this.right=!1,this.bottom=!1,this.mouseclick=!1,document.addEventListener("keydown",function(i){87==i.keyCode&&(t.top=!0),65==i.keyCode&&(t.left=!0),83==i.keyCode&&(t.bottom=!0),68==i.keyCode&&(t.right=!0)},!1),document.addEventListener("keyup",function(i){87==i.keyCode&&(t.top=!1),65==i.keyCode&&(t.left=!1),83==i.keyCode&&(t.bottom=!1),68==i.keyCode&&(t.right=!1)},!1),document.addEventListener("onmousedown",function(i){t.mouseclick=!0},!1),document.addEventListener("onmouseup",function(i){t.mouseclick=!1},!1),document.addEventListener("contextmenu",function(t){t.preventDefault()},!1)}return t}(),o=function(){function t(t,i){this.w=t,this.h=i,this.center=new a.Vector(Math.round(t/2),Math.round(i/2))}return t}(),n=function(){function t(t,i,e){this.vector=new a.Vector(t,i),this.canvas=e,e&&this.setListener(e),this.rotationByCursor=!1,this.angle=0}return t.prototype.setListener=function(){var t=this;t.canvas.addEventListener("mousemove",function(i){var e=t.canvas.getBoundingClientRect();t.vector.x=i.clientX-e.left,t.vector.y=i.clientY-e.top},!1)},t.prototype.getPosition=function(){return this.vector},t}(),s=function(){function t(t,i,e,o,n,s){this.vector=new a.Vector(t,i),this.conversion=e||function(t){t.translate(0,0)},this.gameState=o,this.sprite=n,this.controller=s,this.controller&&(this.controller.ownVec=this.vector)}return t.prototype.change=function(){this.sprite&&this.sprite.next(),this.conversion(this.vector,this.gameState,this.controller)},t.prototype.draw=function(t,i,e,o){this.sprite&&this.sprite.draw(t,this.vector,i,e,o)},t}(),r=function(){function t(t,i,e,o,n){this.vector=new a.Vector(t,i),this.conversion=e||function(t){t.translate(0,0)},this.gameState=o,this.controller=n,this.controller&&(this.controller.ownVec=this.vector)}return t.prototype.change=function(){this.conversion(this.vector,this.gameState,this.controller)},t}(),c=function(){function i(i,e,o,n,s,r,c,h,a){this.source=new Image,this.source.src=i,this.w=e,this.h=o,this.duration=n,this.animationLength=r,this.frameDuration=Math.round(this.duration/t/r),this.currentFrameLifeTime=0,this.firstFrame=s,this.currentFrame=this.firstFrame,this.reverse=!1,this.bounce=c||!1,this.static=h,this.altitude=a}return i.prototype.next=function(){this.currentFrameLifeTime==this.frameDuration?(this.currentFrameLifeTime=0,this.currentFrame+=this.reverse?-1:1):this.currentFrameLifeTime++,this.currentFrame==this.animationLength-1?this.bounce?this.reverse=!0:this.currentFrame=0:0==this.currentFrame&&this.reverse&&(this.reverse=!1)},i.prototype.draw=function(t,i,e,o,n){var s=this,r=0,c=0;n.rotationByCursor&&!o&&(r=20*Math.cos(n.angle),c=20*Math.sin(n.angle)),t.drawImage(s.source,s.currentFrame*s.w,0,s.w,s.h,i.x-Math.round(s.w/2)-(this.static?0:((o?0:Math.round(e.vector.x-e.screen.w/2))+r)*(s.altitude?s.altitude:1)),i.y-Math.round(s.h/2)-(this.static?0:((o?0:Math.round(e.vector.y-e.screen.h/2))+c)*(s.altitude?s.altitude:1)),s.w,s.h)},i}(),h=function(){function t(t,i,e,o,n,s,r){this.velocity=t,this.acceleration=i,this.gameState=e,this.accelerationBoost=o,this.maxVelocity=n,this.minVelocity=-n,this.slipCoefficient=s,this.prevVelocity=t,this.linkedVec=r,this.ownVec={x:0,y:0}}return t.prototype.accelerate=function(){return this.setAcceleration(),this.velocity.x+=this.velocity.x<this.maxVelocity&&this.velocity.x>this.minVelocity?this.acceleration.x:0,this.velocity.y+=this.velocity.y<this.maxVelocity&&this.velocity.y>this.minVelocity?this.acceleration.y:0,this.velocity.x=this.velocity.x>this.maxVelocity?this.maxVelocity:this.velocity.x,this.velocity.y=this.velocity.y>this.maxVelocity?this.maxVelocity:this.velocity.y,this.velocity.x=this.velocity.x<this.minVelocity?this.minVelocity:this.velocity.x,this.velocity.y=this.velocity.y<this.minVelocity?this.minVelocity:this.velocity.y,this.absoluteStopMinVelocity(),this.prevVelocity.x=this.velocity.x,this.prevVelocity.y=this.velocity.y,this.velocity},t.prototype.setAcceleration=function(){this.linkedVec?(this.linkedVec.x<this.ownVec.x?this.acceleration.x=-this.accelerationBoost:this.linkedVec.x>this.ownVec.x?this.acceleration.x=this.accelerationBoost:this.acceleration.x=0,this.linkedVec.y<this.ownVec.y?this.acceleration.y=-this.accelerationBoost:this.linkedVec.y>this.ownVec.y?this.acceleration.y=this.accelerationBoost:this.acceleration.y=0):(this.gameState.left?this.acceleration.x=-this.accelerationBoost:this.gameState.right?this.acceleration.x=this.accelerationBoost:this.acceleration.x=0,this.gameState.top?this.acceleration.y=-this.accelerationBoost:this.gameState.bottom?this.acceleration.y=this.accelerationBoost:this.acceleration.y=0)},t.prototype.absoluteStopMinVelocity=function(){this.velocity.x==this.prevVelocity.x&&0!=this.velocity.x&&this.velocity.x<1&&this.velocity.x>-1&&(this.velocity.x=0),this.velocity.y==this.prevVelocity.y&&0!=this.velocity.y&&this.velocity.y<1&&this.velocity.y>-1&&(this.velocity.y=0)},t.prototype.slip=function(){this.velocity.x-=!this.gameState.right&&this.velocity.x>0?this.slipCoefficient:0,this.velocity.x-=!this.gameState.left&&this.velocity.x<0?-this.slipCoefficient:0,this.velocity.y-=!this.gameState.top&&this.velocity.y<0?-this.slipCoefficient:0,this.velocity.y-=!this.gameState.bottom&&this.velocity.y>0?this.slipCoefficient:0},t}();window.e={Game:i,Camera:r,Screen:o,GameObject:s,Sprite:c,Controller:h}}();